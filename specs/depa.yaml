openapi: 3.0.1
info:
  title: DEPA
  description: DEPA API specs. 
  version: 2.0.0
externalDocs:
  description: Find out more about Depa 2.0
  url: https://www.google.com/search?q=depa
servers:
- url: https://host:2020/cm/depa/v2
  description: CM APIs location
- url: https://host:2020/dc/depa/v2
  description: DC APIs location
- url: https://host:2020/dp/depa/v2
  description: DP APIs location
tags:
- name: Consent Manager (CM)
  description: Endpoints hosted by Consent manager
- name: Data Provider (DP)
  description: Endpoints hosted by Data provider
- name: Data Consumer (DC)
  description: Endpoints hosted by Data consumer


paths:

  /consent:
    post:
      tags:
      - Consent Manager (CM)
      - Data Provider (DP)
      - Data Consumer (DC)
      summary: Post the consent events
      requestBody:
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/cloud.event'
                - type: object
                  properties:
                    data: 
                      type: object
                      anyOf:
                        - $ref: '#/components/schemas/depa.event.consent.requested'
                        - $ref: '#/components/schemas/depa.event.consent.denied'
                        - $ref: '#/components/schemas/depa.event.consent.aborted'
                        - $ref: '#/components/schemas/depa.event.consent.granted'
                        - $ref: '#/components/schemas/depa.event.consent.paused'
                        - $ref: '#/components/schemas/depa.event.consent.resume'
                        - $ref: '#/components/schemas/depa.event.consent.revoked'
                        - $ref: '#/components/schemas/depa.event.consent.unsupported'
      responses:
        200:
          description: OK
        400:
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '#/components/responses/BadEvent'
        401:
          description: Unauthorized Access
        403:
          description: Forbidden
        404:
          description: Not Found
        405:
          description: Method Not Allowed
        500:
          description: Internal Server Error
        501:
          description: Not Implemented
        503:
          description: Service Unavailable

  /data:
    post:
      tags:
      - Consent Manager (CM)
      - Data Provider (DP)
      - Data Consumer (DC)
      summary: Post the data events
      requestBody:
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/cloud.event'
                - type: object
                  properties:
                    data: 
                      type: object
                      anyOf:
                        - $ref: '#/components/schemas/depa.event.data.initiate'
                        - $ref: '#/components/schemas/depa.event.data.prepare'
                        - $ref: '#/components/schemas/depa.event.data.ready'
                        - $ref: '#/components/schemas/depa.event.data.unavailable'
                        - $ref: '#/components/schemas/depa.event.data.fetch'
                        - $ref: '#/components/schemas/depa.event.data.transmitted'
                        - $ref: '#/components/schemas/depa.event.data.recieved'
                        - $ref: '#/components/schemas/depa.event.data.erased'
                        - $ref: '#/components/schemas/depa.event.data.aborted'
      responses:
        200:
          description: OK
        400:
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '#/components/responses/BadEvent'
        401:
          description: Unauthorized Access
        403:
          description: Forbidden
        404:
          description: Not Found
        405:
          description: Method Not Allowed
        500:
          description: Internal Server Error
        501:
          description: Not Implemented
        503:
          description: Service Unavailable
  
  /{}:
    get:
      tags:
        - Data Provider (DP)
      summary: url location to fetch data from
      responses:
        200:
          description: OK
        400:
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '#/components/responses/BadEvent'
        401:
          description: Unauthorized Access
        403:
          description: Forbidden
        404:
          description: Not Found
        405:
          description: Method Not Allowed
        500:
          description: Internal Server Error
        501:
          description: Not Implemented
        503:
          description: Service Unavailable
        


  /link:
    post:
      tags:
      - Consent Manager (CM)
      - Data Provider (DP)
      summary: Post the linking events
      requestBody:
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/cloud.event'
                - type: object
                  properties:
                    data: 
                      type: object
                      anyOf:
                        - $ref: '#/components/schemas/depa.event.link.initiate'
                        - $ref: '#/components/schemas/depa.event.link.established'
                        - $ref: '#/components/schemas/depa.event.link.revoked'
                        - $ref: '#/components/schemas/depa.event.link.aborted'
      responses:
        200:
          description: OK
        400:
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '#/components/responses/BadEvent'
        401:
          description: Unauthorized Access
        403:
          description: Forbidden
        404:
          description: Not Found
        405:
          description: Method Not Allowed
        500:
          description: Internal Server Error
        501:
          description: Not Implemented
        503:
          description: Service Unavailable
          
components:
  schemas:
    $ref: './schema.yaml'
  responses:
    $ref: './responses.yaml'

